(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{380:function(e,t,a){e.exports=a.p+"assets/img/dom-event-capture-bubbling.b6a5618a.png"},467:function(e,t,a){"use strict";a.r(t);var v=a(45),r=Object(v.a)({},(function(){var e=this,t=e.$createElement,v=e._self._c||t;return v("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[v("h1",{attrs:{id:"dom-事件"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#dom-事件"}},[e._v("#")]),e._v(" DOM 事件")]),e._v(" "),v("p",[e._v("网景和微软最早在浏览器端实现了事件，但 API 互不相同，直到 DOM2 开始标准化 DOM 事件 API。现在的浏览器都是按照 "),v("a",{attrs:{href:"https://www.w3.org/TR/DOM-Level-2-Events/events.html",target:"_blank",rel:"noopener noreferrer"}},[e._v("DOM2 Event"),v("OutboundLink")],1),e._v(" 实现的。")]),e._v(" "),v("p",[e._v("事件按照触发源可以划分为：浏览器事件、网络事件、用户事件、计时器事件。")]),e._v(" "),v("h2",{attrs:{id:"基本用法和概念"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#基本用法和概念"}},[e._v("#")]),e._v(" 基本用法和概念")]),e._v(" "),v("h3",{attrs:{id:"注册-绑定事件"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#注册-绑定事件"}},[e._v("#")]),e._v(" 注册/绑定事件")]),e._v(" "),v("p",[v("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Web/API/EventTarget/addEventListener",target:"_blank",rel:"noopener noreferrer"}},[e._v("addEventListener()"),v("OutboundLink")],1),e._v(" 默认会在冒泡阶段注册回调函数，通过 "),v("code",[e._v("useCapture")]),e._v(" 参数可以在捕获阶段注册回调函数。")]),e._v(" "),v("h3",{attrs:{id:"事件流-捕获、到达、冒泡"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#事件流-捕获、到达、冒泡"}},[e._v("#")]),e._v(" 事件流：捕获、到达、冒泡")]),e._v(" "),v("p",[e._v("DOM Level 2 Event 规定事件流的阶段为：捕获 (Capturing)、到达、冒泡 (Bubbling)。")]),e._v(" "),v("p",[e._v("关于这点网上许多资料都说的很清楚了，这里就不赘述了。下图是"),v("a",{attrs:{href:"https://www.tutorialrepublic.com/javascript-tutorial/javascript-event-propagation.php",target:"_blank",rel:"noopener noreferrer"}},[e._v("网上找的"),v("OutboundLink")],1),e._v("。")]),e._v(" "),v("p",[v("img",{attrs:{src:a(380),alt:""}})]),e._v(" "),v("p",[e._v("通过 "),v("code",[e._v("stopPropagation()")]),e._v(" 不仅可以阻止冒泡，还可以阻止捕获。冒泡的英文是 bubble，捕获的英文是 capture，而 propatate 是二者的统称。因此许多中文文档将 stopPropagation 解释为阻止冒泡是不准确的。")]),e._v(" "),v("p",[e._v("在实际开发中，如果不能理解时间的冒泡、捕获阶段，则可能产生自己难以理解的 BUG。例如 MDN 上的"),v("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Learn/JavaScript/Building_blocks/Events#%E4%BA%8B%E4%BB%B6%E5%86%92%E6%B3%A1%E5%8F%8A%E6%8D%95%E8%8E%B7",target:"_blank",rel:"noopener noreferrer"}},[e._v("这个例子"),v("OutboundLink")],1),e._v("就演示了一个非常简单的业务场景下都会产生的令人费解的 BUG。")]),e._v(" "),v("h2",{attrs:{id:"event-对象"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#event-对象"}},[e._v("#")]),e._v(" Event 对象")]),e._v(" "),v("p",[e._v("事件处理函数接受的参数就是一个 Event 对象，"),v("code",[e._v("btn.addEventListener('click', function (evt) { })")]),e._v("。")]),e._v(" "),v("p",[e._v("Event 有很多类别，包括 KeyboardEvent、MouseEvent、TouchEvent 等等。常用的属性有 "),v("code",[e._v("Event.target")]),e._v("，常用的方法有 "),v("code",[e._v("Event.preventDefault()")]),e._v("、"),v("code",[e._v("Event.stopPropagation()")]),e._v(" 等。完整的列表可以看"),v("a",{attrs:{href:"https://developer.mozilla.org/en-US/docs/Web/API/Event",target:"_blank",rel:"noopener noreferrer"}},[e._v("API 文档"),v("OutboundLink")],1),e._v("。")]),e._v(" "),v("h2",{attrs:{id:"常用事件"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#常用事件"}},[e._v("#")]),e._v(" 常用事件")]),e._v(" "),v("h3",{attrs:{id:"uievent"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#uievent"}},[e._v("#")]),e._v(" UIEvent")]),e._v(" "),v("p",[e._v("常用的事件有：load、unload、scroll、resize")]),e._v(" "),v("h3",{attrs:{id:"focusevent"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#focusevent"}},[e._v("#")]),e._v(" FocusEvent")]),e._v(" "),v("p",[e._v("常用的事件有：focus、blur")]),e._v(" "),v("h3",{attrs:{id:"mouseevent、wheelevent、dragevent"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#mouseevent、wheelevent、dragevent"}},[e._v("#")]),e._v(" MouseEvent、WheelEvent、DragEvent")]),e._v(" "),v("p",[e._v("MouseEvent 是鼠标事件，常用的有：click、dblclick、mousedown、mouseup、mouseenter、mouseleave、mouseover。")]),e._v(" "),v("p",[e._v("WheelEvent 和 DragEvent 派生自 MouseEvent，分别表示滚轮事件和拖拽事件。")]),e._v(" "),v("p",[e._v("触屏设备上有一些不同：")]),e._v(" "),v("ul",[v("li",[e._v("不支持 dblclick 事件，因为双击被用作放大页面")]),e._v(" "),v("li",[e._v("click 事件会慢 300ms，除非加上"),v("code",[e._v('<meta name="viewport" content="width=device-width">')])])]),e._v(" "),v("h3",{attrs:{id:"keyboardevent"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#keyboardevent"}},[e._v("#")]),e._v(" KeyboardEvent")]),e._v(" "),v("p",[e._v("键盘事件，常用的有：keydown、keyup。")]),e._v(" "),v("h2",{attrs:{id:"最佳实践"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#最佳实践"}},[e._v("#")]),e._v(" 最佳实践")]),e._v(" "),v("h3",{attrs:{id:"节流、防抖"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#节流、防抖"}},[e._v("#")]),e._v(" 节流、防抖")]),e._v(" "),v("p",[e._v("一些事件会被高频率触发 (如 mousemove)，这样事件处理函数也会被高频调用，非常耗费性能和资源。")]),e._v(" "),v("p",[e._v("一般我们会使用 lodash 库提供的节流防抖接口："),v("code",[e._v("_.debounce(func, wait, {leading, trailing, maxWait})")]),e._v("、"),v("code",[e._v("_.throttle(func, wait, {leading, trailing})")]),e._v("。")]),e._v(" "),v("p",[e._v("手写简易的节流防抖很容易，但功能完备的很难。")]),e._v(" "),v("p",[e._v("应用场景：")]),e._v(" "),v("ul",[v("li",[e._v("窗口 resize 事件，需要调用 EChart 之类的库重新绘制，使用防抖")]),e._v(" "),v("li",[e._v("搜索框的输入建议，根据需求使用节流防抖都行")]),e._v(" "),v("li",[e._v("无限滚动页，页面滚动监听事件，用节流")])]),e._v(" "),v("h3",{attrs:{id:"事件委托-代理"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#事件委托-代理"}},[e._v("#")]),e._v(" 事件委托/代理")]),e._v(" "),v("p",[e._v("如果为每个 DOM 元素都绑定事件回调，那么会很浪费内存。事件委托的关键：首先在顶层元素绑定事件，然后根据 "),v("code",[e._v("event.target")]),e._v(" 判断事件的触发元素是否是我们需要处理的。")])])}),[],!1,null,null,null);t.default=r.exports}}]);